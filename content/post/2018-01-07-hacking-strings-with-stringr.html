---
title: Hacking strings with stringr
author: Aravind Hebbali
date: '2018-01-07'
slug: hacking-strings-with-stringr
categories:
  - data wrangling
tags:
  - strings
---



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this post, we will learn to work with string data in R using <a href="http://stringr.tidyverse.org">stringr</a>. As we did in the other posts, we will use a case study to explore the various features of the stringr package. Let us begin by installing and loading stringr and a set of other pacakges we will be using.</p>
</div>
<div id="libraries-code-data" class="section level2">
<h2>Libraries, Code &amp; Data</h2>
<p>We will use the following libraries:</p>
<ul>
<li><a href="http://lubridate.tidyverse.org/index.html">stringr</a></li>
<li><a href="http://dplyr.tidyverse.org/index.html">dplyr</a></li>
<li><a href="http://magrittr.tidyverse.org/index.html">magrittr</a></li>
<li><a href="http://tibble.tidyverse.org/index.html">tibble</a></li>
<li><a href="http://purrr.tidyverse.org/index.html">purrr</a></li>
<li>and <a href="http://readr.tidyverse.org/index.html">readr</a></li>
</ul>
<p>The data sets can be downloaded from <a href="https://github.com/rsquaredacademy/datasets">here</a> and the codes from <a href="https://gist.github.com/aravindhebbali/5d1799744e55dc76cdf1af6b1cc03c82">here</a>.</p>
<pre class="r"><code>library(stringr)
library(tibble)
library(magrittr)
library(purrr)
library(dplyr)
library(readr)</code></pre>
</div>
<div id="case-study" class="section level2">
<h2>Case Study</h2>
<ul>
<li>extract domain name from random email ids</li>
<li>extract image type from url</li>
<li>extract image dimension from url</li>
<li>extract extension from domain name</li>
<li>extract http protocol from url</li>
<li>extract file type from url</li>
</ul>
<div id="data" class="section level3">
<h3>Data</h3>
<pre class="r"><code>mockstring &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rsquaredacademy/datasets/master/mock_strings.csv&#39;)
mockstring</code></pre>
<pre><code>## # A tibble: 1,000 x 12
##       id image_url  domain imageurl email filename phone address url      
##    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    
##  1     1 https://r~ addto~ http://~ mnew~ PedeMal~ 66-(~ 8 Anha~ https://~
##  2     2 https://r~ gmpg.~ http://~ mdan~ Loborti~ 351-~ 697 Ea~ http://d~
##  3     3 https://r~ samsu~ http://~ hgir~ CongueD~ 33-(~ 89 Dot~ https://~
##  4     4 https://r~ spoti~ http://~ pmcm~ Eleifen~ 86-(~ 98135 ~ http://i~
##  5     5 https://r~ wunde~ http://~ dris~ PurusPh~ 223-~ 7814 P~ https://~
##  6     6 https://r~ alexa~ http://~ cphl~ Element~ 420-~ 4897 L~ https://~
##  7     7 https://r~ googl~ http://~ kdod~ Mattis.~ 1-(7~ 53541 ~ http://v~
##  8     8 https://r~ ed.gov http://~ vhou~ PurusEu~ 62-(~ 4819 H~ https://~
##  9     9 https://r~ jigsy~ http://~ rdik~ JustoEt~ 1-(6~ 68096 ~ https://~
## 10    10 https://r~ jugem~ http://~ tdud~ Ante.ti~ 30-(~ 9595 S~ https://~
## # ... with 990 more rows, and 3 more variables: full_name &lt;chr&gt;,
## #   currency &lt;chr&gt;, passwords &lt;chr&gt;</code></pre>
</div>
<div id="data-dictionary" class="section level3">
<h3>Data Dictionary</h3>
<ul>
<li>domain: dummy website domain</li>
<li>imageurl: url of an image</li>
<li>email: dummy email id</li>
<li>filename: dummy file name with different extensions</li>
<li>phone: dummy phone number</li>
<li>address: dummy address with door and street names</li>
<li>url: randomyly generated urls</li>
<li>full_name: dummy first and last names</li>
<li>currency: different currencies</li>
<li>passwords: dummy passwords</li>
</ul>
</div>
</div>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Before we start with the case study, let us take a quick tour of <strong>stringr</strong> and introduce
ourselves to some of the functions we will be using later in the case study. One of the
columns in the case study data is <code>email</code>. It contains random email ids. We want to ensure
that the email ids adher to a particular format .i.e</p>
<ul>
<li>they contain <code>@</code></li>
<li>they contain only one <code>@</code></li>
</ul>
<p>Let us first detect if the email ids contain <code>@</code>. Since the data set has 1000 rows, we will
use a smaller sample in the examples.</p>
<pre class="r"><code>mockdata &lt;- slice(mockstring, 1:10)
mockdata</code></pre>
<pre><code>## # A tibble: 10 x 12
##       id image_url  domain imageurl email filename phone address url      
##    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    
##  1     1 https://r~ addto~ http://~ mnew~ PedeMal~ 66-(~ 8 Anha~ https://~
##  2     2 https://r~ gmpg.~ http://~ mdan~ Loborti~ 351-~ 697 Ea~ http://d~
##  3     3 https://r~ samsu~ http://~ hgir~ CongueD~ 33-(~ 89 Dot~ https://~
##  4     4 https://r~ spoti~ http://~ pmcm~ Eleifen~ 86-(~ 98135 ~ http://i~
##  5     5 https://r~ wunde~ http://~ dris~ PurusPh~ 223-~ 7814 P~ https://~
##  6     6 https://r~ alexa~ http://~ cphl~ Element~ 420-~ 4897 L~ https://~
##  7     7 https://r~ googl~ http://~ kdod~ Mattis.~ 1-(7~ 53541 ~ http://v~
##  8     8 https://r~ ed.gov http://~ vhou~ PurusEu~ 62-(~ 4819 H~ https://~
##  9     9 https://r~ jigsy~ http://~ rdik~ JustoEt~ 1-(6~ 68096 ~ https://~
## 10    10 https://r~ jugem~ http://~ tdud~ Ante.ti~ 30-(~ 9595 S~ https://~
## # ... with 3 more variables: full_name &lt;chr&gt;, currency &lt;chr&gt;,
## #   passwords &lt;chr&gt;</code></pre>
<p>Use <code>str_detect()</code> to detect <code>@</code> and <code>str_count()</code> to count the number of times
<code>@</code> appears in the email ids.</p>
<pre class="r"><code># detect @
str_detect(mockdata$email, pattern = &quot;@&quot;)</code></pre>
<pre><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
<pre class="r"><code># count @
str_count(mockdata$email, pattern = &quot;@&quot;)</code></pre>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1</code></pre>
<p>We can use <code>str_c()</code> to concatenate strings. Let us add the string <code>email id:</code> before each
email id in the data set.</p>
<pre class="r"><code>str_c(&quot;email id:&quot;, mockdata$email)</code></pre>
<pre><code>##  [1] &quot;email id:mnewburn0@fastcompany.com&quot;   
##  [2] &quot;email id:mdankersley1@digg.com&quot;       
##  [3] &quot;email id:hgirhard2@altervista.org&quot;    
##  [4] &quot;email id:pmcmenamy3@sciencedirect.com&quot;
##  [5] &quot;email id:drisbrough4@bandcamp.com&quot;    
##  [6] &quot;email id:cphlippi5@surveymonkey.com&quot;  
##  [7] &quot;email id:kdodswell6@un.org&quot;           
##  [8] &quot;email id:vhourihane7@ovh.net&quot;         
##  [9] &quot;email id:rdike8@timesonline.co.uk&quot;    
## [10] &quot;email id:tdudbridge9@clickbank.net&quot;</code></pre>
<p>If we want to split a string into two parts using a particular pattern, we use <code>str_split()</code>.
Let us split the domain name and extension from the domain column in the data. The domain name
and extension are separated by <code>.</code> and we will use it to split the domain column. Since <code>.</code> is
a special character, we will use two slashes to escape the special character.</p>
<pre class="r"><code>str_split(mockdata$domain, pattern = &quot;\\.&quot;)</code></pre>
<pre><code>## [[1]]
## [1] &quot;addtoany&quot; &quot;com&quot;     
## 
## [[2]]
## [1] &quot;gmpg&quot; &quot;org&quot; 
## 
## [[3]]
## [1] &quot;samsung&quot; &quot;com&quot;    
## 
## [[4]]
## [1] &quot;spotify&quot; &quot;com&quot;    
## 
## [[5]]
## [1] &quot;wunderground&quot; &quot;com&quot;         
## 
## [[6]]
## [1] &quot;alexa&quot; &quot;com&quot;  
## 
## [[7]]
## [1] &quot;google&quot; &quot;it&quot;    
## 
## [[8]]
## [1] &quot;ed&quot;  &quot;gov&quot;
## 
## [[9]]
## [1] &quot;jigsy&quot; &quot;com&quot;  
## 
## [[10]]
## [1] &quot;jugem&quot; &quot;jp&quot;</code></pre>
<p>We can truncate a string using <code>str_trunc()</code>. The default truncation happens at the beggining
of the string but we can truncate the central part or the end of the string as well.</p>
<pre class="r"><code>str_trunc(mockdata$email, width = 10)</code></pre>
<pre><code>##  [1] &quot;mnewbur...&quot; &quot;mdanker...&quot; &quot;hgirhar...&quot; &quot;pmcmena...&quot; &quot;drisbro...&quot;
##  [6] &quot;cphlipp...&quot; &quot;kdodswe...&quot; &quot;vhourih...&quot; &quot;rdike8@...&quot; &quot;tdudbri...&quot;</code></pre>
<pre class="r"><code>str_trunc(mockdata$email, width = 10, side = &quot;left&quot;)</code></pre>
<pre><code>##  [1] &quot;...any.com&quot; &quot;...igg.com&quot; &quot;...sta.org&quot; &quot;...ect.com&quot; &quot;...amp.com&quot;
##  [6] &quot;...key.com&quot; &quot;...@un.org&quot; &quot;...ovh.net&quot; &quot;...e.co.uk&quot; &quot;...ank.net&quot;</code></pre>
<pre class="r"><code>str_trunc(mockdata$email, width = 10, side = &quot;center&quot;)</code></pre>
<pre><code>##  [1] &quot;mnew...com&quot; &quot;mdan...com&quot; &quot;hgir...org&quot; &quot;pmcm...com&quot; &quot;dris...com&quot;
##  [6] &quot;cphl...com&quot; &quot;kdod...org&quot; &quot;vhou...net&quot; &quot;rdik....uk&quot; &quot;tdud...net&quot;</code></pre>
<p>Strings can be sorted using <code>str_sort()</code>. Let us quickly sort the emails in both
ascending and descending orders.</p>
<pre class="r"><code>str_sort(mockdata$email)</code></pre>
<pre><code>##  [1] &quot;cphlippi5@surveymonkey.com&quot;   &quot;drisbrough4@bandcamp.com&quot;    
##  [3] &quot;hgirhard2@altervista.org&quot;     &quot;kdodswell6@un.org&quot;           
##  [5] &quot;mdankersley1@digg.com&quot;        &quot;mnewburn0@fastcompany.com&quot;   
##  [7] &quot;pmcmenamy3@sciencedirect.com&quot; &quot;rdike8@timesonline.co.uk&quot;    
##  [9] &quot;tdudbridge9@clickbank.net&quot;    &quot;vhourihane7@ovh.net&quot;</code></pre>
<pre class="r"><code>str_sort(mockdata$email, decreasing = TRUE)</code></pre>
<pre><code>##  [1] &quot;vhourihane7@ovh.net&quot;          &quot;tdudbridge9@clickbank.net&quot;   
##  [3] &quot;rdike8@timesonline.co.uk&quot;     &quot;pmcmenamy3@sciencedirect.com&quot;
##  [5] &quot;mnewburn0@fastcompany.com&quot;    &quot;mdankersley1@digg.com&quot;       
##  [7] &quot;kdodswell6@un.org&quot;            &quot;hgirhard2@altervista.org&quot;    
##  [9] &quot;drisbrough4@bandcamp.com&quot;     &quot;cphlippi5@surveymonkey.com&quot;</code></pre>
<p>The case of a string can be changed to upper, lower or title case as shown below.</p>
<pre class="r"><code>str_to_upper(mockdata$full_name)</code></pre>
<pre><code>##  [1] &quot;MUFI RUIT&quot;          &quot;LEESE FURMAGIER&quot;    &quot;BLAKELEE WILSHIRE&quot; 
##  [4] &quot;TERENCIO MCILLRICK&quot; &quot;DEBEE MCERLAINE&quot;    &quot;FRAN PAINTEN&quot;      
##  [7] &quot;FRASCO BOWICH&quot;      &quot;CAR PONTEN&quot;         &quot;TADES CHECCUCCI&quot;   
## [10] &quot;WILTON KEMMEY&quot;</code></pre>
<pre class="r"><code>str_to_lower(mockdata$full_name)</code></pre>
<pre><code>##  [1] &quot;mufi ruit&quot;          &quot;leese furmagier&quot;    &quot;blakelee wilshire&quot; 
##  [4] &quot;terencio mcillrick&quot; &quot;debee mcerlaine&quot;    &quot;fran painten&quot;      
##  [7] &quot;frasco bowich&quot;      &quot;car ponten&quot;         &quot;tades checcucci&quot;   
## [10] &quot;wilton kemmey&quot;</code></pre>
<p>Parts of a string can be replaced using <code>str_replace()</code>. In the <code>address</code> column of the data set,
let us replace:</p>
<ul>
<li>Street with ST</li>
<li>Road with RD</li>
</ul>
<pre class="r"><code>str_replace(mockdata$address, &quot;Street&quot;, &quot;ST&quot;)</code></pre>
<pre><code>##  [1] &quot;8 Anhalt Crossing&quot;          &quot;697 East Avenue&quot;           
##  [3] &quot;89 Dottie Circle&quot;           &quot;98135 Blue Bill Park Drive&quot;
##  [5] &quot;7814 Pennsylvania ST&quot;       &quot;4897 Little Fleur Drive&quot;   
##  [7] &quot;53541 Morrow Center&quot;        &quot;4819 Hermina Parkway&quot;      
##  [9] &quot;68096 Monument Park&quot;        &quot;9595 Spaight Avenue&quot;</code></pre>
<pre class="r"><code>str_replace(mockdata$address, &quot;Road&quot;, &quot;RD&quot;)</code></pre>
<pre><code>##  [1] &quot;8 Anhalt Crossing&quot;          &quot;697 East Avenue&quot;           
##  [3] &quot;89 Dottie Circle&quot;           &quot;98135 Blue Bill Park Drive&quot;
##  [5] &quot;7814 Pennsylvania Street&quot;   &quot;4897 Little Fleur Drive&quot;   
##  [7] &quot;53541 Morrow Center&quot;        &quot;4819 Hermina Parkway&quot;      
##  [9] &quot;68096 Monument Park&quot;        &quot;9595 Spaight Avenue&quot;</code></pre>
<p>We can extract parts of the string that match a particular pattern using <code>str_extract()</code>.</p>
<pre class="r"><code>str_extract(mockdata$email, pattern = &quot;org&quot;)</code></pre>
<pre><code>##  [1] NA    NA    &quot;org&quot; NA    NA    NA    &quot;org&quot; NA    NA    NA</code></pre>
<p>Before we extract, we need to know whether the string contains text that match our pattern.
Use <code>str_match()</code> to see if the pattern is present in the string.</p>
<pre class="r"><code>str_match(mockdata$email, pattern = &quot;org&quot;)</code></pre>
<pre><code>##       [,1] 
##  [1,] NA   
##  [2,] NA   
##  [3,] &quot;org&quot;
##  [4,] NA   
##  [5,] NA   
##  [6,] NA   
##  [7,] &quot;org&quot;
##  [8,] NA   
##  [9,] NA   
## [10,] NA</code></pre>
<p>If we are dealing with a character vector and know that the pattern we are looking at
is present in the vector, we might want to know the index of the strings in which it is
present. Use <code>str_which()</code> to identify the index of the strings that match our pattern.</p>
<pre class="r"><code>str_which(mockdata$email, pattern = &quot;org&quot;)</code></pre>
<pre><code>## [1] 3 7</code></pre>
<p>Another objective might be to locate the position of the pattern we are looking for in the
string. For example, if we want to know the position of <code>@</code> in the email ids, we can use
<code>str_locate()</code>.</p>
<pre class="r"><code>str_locate(mockdata$email, pattern = &quot;@&quot;)</code></pre>
<pre><code>##       start end
##  [1,]    10  10
##  [2,]    13  13
##  [3,]    10  10
##  [4,]    11  11
##  [5,]    12  12
##  [6,]    10  10
##  [7,]    11  11
##  [8,]    12  12
##  [9,]     7   7
## [10,]    12  12</code></pre>
<p>The length of the string can be computed using <code>str_length()</code>. Let us ensure that the length
of the strings in the <code>password</code> column is 16.</p>
<pre class="r"><code>str_length(mockdata$passwords)</code></pre>
<pre><code>##  [1] 16 16 16 16 16 16 16 16 16 16</code></pre>
<p>We can extract parts of a string by specifying the starting and ending position using
<code>str_sub()</code>. Let us extract the currency type from the <code>currency</code> column.</p>
<pre class="r"><code>str_sub(mockdata$currency, start = 1, end = 1)</code></pre>
<pre><code>##  [1] &quot;¥&quot; &quot;$&quot; &quot;€&quot; &quot;€&quot; &quot;€&quot; &quot;¥&quot; &quot;$&quot; &quot;¥&quot; &quot;€&quot; &quot;€&quot;</code></pre>
<p>One final function that we will look at before the case study is <code>word()</code>. It extracts
word(s) from sentences. We do not have any senetences in the data set, but let us use it
to extract the first and last name from the <code>full_name</code> column.</p>
<pre class="r"><code>word(mockdata$full_name, 1)</code></pre>
<pre><code>##  [1] &quot;Mufi&quot;     &quot;Leese&quot;    &quot;Blakelee&quot; &quot;Terencio&quot; &quot;Debee&quot;    &quot;Fran&quot;    
##  [7] &quot;Frasco&quot;   &quot;Car&quot;      &quot;Tades&quot;    &quot;Wilton&quot;</code></pre>
<pre class="r"><code>word(mockdata$full_name, 2)</code></pre>
<pre><code>##  [1] &quot;Ruit&quot;      &quot;Furmagier&quot; &quot;Wilshire&quot;  &quot;McIllrick&quot; &quot;McErlaine&quot;
##  [6] &quot;Painten&quot;   &quot;Bowich&quot;    &quot;Ponten&quot;    &quot;Checcucci&quot; &quot;Kemmey&quot;</code></pre>
<p>Alright, now let us apply what we have learned so far to our case study.</p>
</div>
<div id="extract-domain-name-from-email-ids" class="section level2">
<h2>Extract domain name from email ids</h2>
<div id="steps" class="section level3">
<h3>Steps</h3>
<ul>
<li>split email using pattern <code>@</code></li>
<li>extract the second element from the resulting list</li>
<li>split the above using pattern <code>\\.</code></li>
<li>extract the first element from the resulting list</li>
</ul>
<p>Let us take a look at the emails before we extract the domain names.</p>
<pre class="r"><code>emails &lt;- 
  mockstring %&gt;%
  pull(email) %&gt;%
  head

emails</code></pre>
<pre><code>## [1] &quot;mnewburn0@fastcompany.com&quot;    &quot;mdankersley1@digg.com&quot;       
## [3] &quot;hgirhard2@altervista.org&quot;     &quot;pmcmenamy3@sciencedirect.com&quot;
## [5] &quot;drisbrough4@bandcamp.com&quot;     &quot;cphlippi5@surveymonkey.com&quot;</code></pre>
<div id="step-1-split-email-using-pattern-." class="section level4">
<h4>Step 1: Split email using pattern <code>@</code>.</h4>
<p>We will split the email using <code>str_split</code>. It will split a string
using the pattern supplied. In our case the pattern is <code>@</code>.</p>
<pre class="r"><code> str_split(emails, pattern = &#39;@&#39;)</code></pre>
<pre><code>## [[1]]
## [1] &quot;mnewburn0&quot;       &quot;fastcompany.com&quot;
## 
## [[2]]
## [1] &quot;mdankersley1&quot; &quot;digg.com&quot;    
## 
## [[3]]
## [1] &quot;hgirhard2&quot;      &quot;altervista.org&quot;
## 
## [[4]]
## [1] &quot;pmcmenamy3&quot;        &quot;sciencedirect.com&quot;
## 
## [[5]]
## [1] &quot;drisbrough4&quot;  &quot;bandcamp.com&quot;
## 
## [[6]]
## [1] &quot;cphlippi5&quot;        &quot;surveymonkey.com&quot;</code></pre>
</div>
<div id="step-2-extract-the-second-element-from-the-resulting-list." class="section level4">
<h4>Step 2: Extract the second element from the resulting list.</h4>
<p>Step 1 returned a list. Each element of the list has two values. The first
one is the username and the second is the domain name. Since we are
extracting the domain name, we want the second value from each element of
the list.</p>
<p>We will use <code>map_chr()</code> from purrr to extract the domain names. It will
return the second value from each element in the list. Since the domain
name is a string, <code>map_chr()</code> will return a character vector.</p>
<pre class="r"><code>emails %&gt;%
  str_split(pattern = &#39;@&#39;) %&gt;%
  map_chr(2)</code></pre>
<pre><code>## [1] &quot;fastcompany.com&quot;   &quot;digg.com&quot;          &quot;altervista.org&quot;   
## [4] &quot;sciencedirect.com&quot; &quot;bandcamp.com&quot;      &quot;surveymonkey.com&quot;</code></pre>
</div>
<div id="step-3-split-the-above-using-pattern-.." class="section level4">
<h4>Step 3: Split the above using pattern <code>\\.</code>.</h4>
<p>We want the domain name and not the extension. Step 2 returned a
character vector and we need to split the domain name and the domain
extension. They are separated by <code>.</code>. Since <code>.</code> is a special character,
we will use <code>\\</code> before <code>.</code> to escape it. Let us split the domain
name and domain extension using <code>str_split</code> and <code>\\.</code> as the pattern.</p>
<pre class="r"><code>emails %&gt;%
  str_split(pattern = &#39;@&#39;) %&gt;%
  map_chr(2) %&gt;%
  str_split(pattern = &#39;\\.&#39;) </code></pre>
<pre><code>## [[1]]
## [1] &quot;fastcompany&quot; &quot;com&quot;        
## 
## [[2]]
## [1] &quot;digg&quot; &quot;com&quot; 
## 
## [[3]]
## [1] &quot;altervista&quot; &quot;org&quot;       
## 
## [[4]]
## [1] &quot;sciencedirect&quot; &quot;com&quot;          
## 
## [[5]]
## [1] &quot;bandcamp&quot; &quot;com&quot;     
## 
## [[6]]
## [1] &quot;surveymonkey&quot; &quot;com&quot;</code></pre>
</div>
<div id="step-4-extract-the-first-element-from-the-resulting-list." class="section level4">
<h4>Step 4: Extract the first element from the resulting list.</h4>
<p>Now that we have separated the domain name from its extension, let us extract
the first value from each element in the list returned in step 3. We will again
use <code>map_chr</code> to achieve this.</p>
<pre class="r"><code>emails %&gt;%
  str_split(pattern = &#39;@&#39;) %&gt;%
  map_chr(2) %&gt;%
  str_split(pattern = &#39;\\.&#39;) %&gt;%
  map_chr(extract(1))</code></pre>
<pre><code>## [1] &quot;fastcompany&quot;   &quot;digg&quot;          &quot;altervista&quot;    &quot;sciencedirect&quot;
## [5] &quot;bandcamp&quot;      &quot;surveymonkey&quot;</code></pre>
</div>
</div>
</div>
<div id="extract-domain-extension" class="section level2">
<h2>Extract Domain Extension</h2>
<p>The below code extracts the domain extension instead of the domain name.</p>
<pre class="r"><code>emails %&gt;%
  str_split(pattern = &#39;@&#39;) %&gt;%
  map_chr(2) %&gt;%
  str_split(pattern = &#39;\\.&#39;, simplify = TRUE) %&gt;%
  extract(, 2)</code></pre>
<pre><code>## [1] &quot;com&quot; &quot;com&quot; &quot;org&quot; &quot;com&quot; &quot;com&quot; &quot;com&quot;</code></pre>
</div>
<div id="extract-image-type-from-url" class="section level2">
<h2>Extract image type from URL</h2>
<div id="steps-1" class="section level3">
<h3>Steps</h3>
<ul>
<li>split imageurl using pattern <code>\\.</code></li>
<li>extract the third value from each element of the resulting list</li>
<li>subset the string using the index position</li>
</ul>
<p>Let us take a look at the URL of the image.</p>
<pre class="r"><code>img &lt;- 
  mockstring %&gt;%
  pull(imageurl) %&gt;%
  head

img</code></pre>
<pre><code>## [1] &quot;http://dummyimage.com/130x183.jpg/dddddd/000000&quot;
## [2] &quot;http://dummyimage.com/106x217.bmp/dddddd/000000&quot;
## [3] &quot;http://dummyimage.com/146x127.bmp/cc0000/ffffff&quot;
## [4] &quot;http://dummyimage.com/181x194.png/5fa2dd/ffffff&quot;
## [5] &quot;http://dummyimage.com/220x123.jpg/ff4444/ffffff&quot;
## [6] &quot;http://dummyimage.com/118x176.bmp/dddddd/000000&quot;</code></pre>
<div id="step-1-split-imageurl-using-pattern-." class="section level4">
<h4>Step 1: Split imageurl using pattern <code>\\.</code></h4>
<p>Let us split imageurl using <code>str_split</code> and the pattern <code>\\.</code>.</p>
<pre class="r"><code>img %&gt;%
  str_split(pattern = &#39;\\.&#39;)</code></pre>
<pre><code>## [[1]]
## [1] &quot;http://dummyimage&quot; &quot;com/130x183&quot;       &quot;jpg/dddddd/000000&quot;
## 
## [[2]]
## [1] &quot;http://dummyimage&quot; &quot;com/106x217&quot;       &quot;bmp/dddddd/000000&quot;
## 
## [[3]]
## [1] &quot;http://dummyimage&quot; &quot;com/146x127&quot;       &quot;bmp/cc0000/ffffff&quot;
## 
## [[4]]
## [1] &quot;http://dummyimage&quot; &quot;com/181x194&quot;       &quot;png/5fa2dd/ffffff&quot;
## 
## [[5]]
## [1] &quot;http://dummyimage&quot; &quot;com/220x123&quot;       &quot;jpg/ff4444/ffffff&quot;
## 
## [[6]]
## [1] &quot;http://dummyimage&quot; &quot;com/118x176&quot;       &quot;bmp/dddddd/000000&quot;</code></pre>
</div>
<div id="step-2-extract-the-third-value-from-each-element-of-the-resulting-list" class="section level4">
<h4>Step 2: Extract the third value from each element of the resulting list</h4>
<p>Step 1 returned a list the elements of which have 3 values each. If you
observe the list, the image type is in the 3rd value. We will now
extract the third value from each element of the list using <code>map_chr</code>.</p>
<pre class="r"><code>img %&gt;%
  str_split(pattern = &#39;\\.&#39;) %&gt;%
  map_chr(extract(3))</code></pre>
<pre><code>## [1] &quot;jpg/dddddd/000000&quot; &quot;bmp/dddddd/000000&quot; &quot;bmp/cc0000/ffffff&quot;
## [4] &quot;png/5fa2dd/ffffff&quot; &quot;jpg/ff4444/ffffff&quot; &quot;bmp/dddddd/000000&quot;</code></pre>
</div>
<div id="step-3-subset-the-string-using-the-index-position" class="section level4">
<h4>Step 3: Subset the string using the index position</h4>
<p>We can now extract the image type in two ways:</p>
<ul>
<li>subset the first 3 characters of the string</li>
<li>split the string using pattern <code>/</code> and extract the first value from the
elements of the resulting list</li>
</ul>
<p>Below is the first method. We know that the image type is 3 characters. So
we use <code>str_sub</code> to subset the first 3 characters. The index positions
are mentioned using <code>start</code> and <code>stop</code>.</p>
<pre class="r"><code>img %&gt;%
  str_split(pattern = &#39;\\.&#39;) %&gt;%
  map_chr(extract(3)) %&gt;%
  str_sub(start = 1, end = 3)</code></pre>
<pre><code>## [1] &quot;jpg&quot; &quot;bmp&quot; &quot;bmp&quot; &quot;png&quot; &quot;jpg&quot; &quot;bmp&quot;</code></pre>
<p>In case you are not sure about the length of the image type. In such cases,
we will split the string using pattern <code>/</code> and then use <code>map_chr</code> to
extract the first value of each element of the resulting list.</p>
<pre class="r"><code>img %&gt;%
  str_split(pattern = &#39;\\.&#39;) %&gt;%
  map_chr(extract(3)) %&gt;%
  str_split(pattern = &#39;/&#39;) %&gt;%
  map_chr(extract(1))</code></pre>
<pre><code>## [1] &quot;jpg&quot; &quot;bmp&quot; &quot;bmp&quot; &quot;png&quot; &quot;jpg&quot; &quot;bmp&quot;</code></pre>
</div>
</div>
</div>
<div id="extract-image-dimesion-from-url" class="section level2">
<h2>Extract Image Dimesion from URL</h2>
<div id="steps-2" class="section level3">
<h3>Steps</h3>
<ul>
<li>locate numbers between 0 and 9</li>
<li>extract part of url starting with image dimension</li>
<li>split the string using the pattern <code>\\.</code></li>
<li>extract the first element</li>
</ul>
<div id="step-1-locate-numbers-between-0-and-9." class="section level4">
<h4>Step 1: Locate numbers between 0 and 9.</h4>
<p>Let us inspect the image url. The dimension of the image appears
after the domain extension and there are no numbers in the url
before. We will locate the position or index of the first number
in the url using <code>str_locate()</code> and using the pattern <code>[0-9]</code>
which instructs to look for any number between and including 0
and 9.</p>
<pre class="r"><code>img %&gt;%
  str_locate(pattern = &quot;[0-9]&quot;) </code></pre>
<pre><code>##      start end
## [1,]    23  23
## [2,]    23  23
## [3,]    23  23
## [4,]    23  23
## [5,]    23  23
## [6,]    23  23</code></pre>
</div>
<div id="step-2-extract-url" class="section level4">
<h4>Step 2: Extract url</h4>
<p>We know where the dimension is located in the url. Let us extract the
part of the url that contains the image dimension using <code>str_sub()</code>.</p>
<pre class="r"><code>img %&gt;%
  str_sub(start = 23) </code></pre>
<pre><code>## [1] &quot;130x183.jpg/dddddd/000000&quot; &quot;106x217.bmp/dddddd/000000&quot;
## [3] &quot;146x127.bmp/cc0000/ffffff&quot; &quot;181x194.png/5fa2dd/ffffff&quot;
## [5] &quot;220x123.jpg/ff4444/ffffff&quot; &quot;118x176.bmp/dddddd/000000&quot;</code></pre>
</div>
<div id="step-3-split-the-string-using-the-pattern-.." class="section level4">
<h4>Step 3: Split the string using the pattern <code>\\.</code>.</h4>
<p>From the previous step, we have the part of the url that
contains the image dimension. To extract the dimension, we
will split it from the rest of the url using <code>str_split()</code>
and using the pattern <code>\\.</code> as it separates the dimension
and the image extension.</p>
<pre class="r"><code>img %&gt;%
  str_sub(start = 23) %&gt;%
  str_split(pattern = &#39;\\.&#39;) </code></pre>
<pre><code>## [[1]]
## [1] &quot;130x183&quot;           &quot;jpg/dddddd/000000&quot;
## 
## [[2]]
## [1] &quot;106x217&quot;           &quot;bmp/dddddd/000000&quot;
## 
## [[3]]
## [1] &quot;146x127&quot;           &quot;bmp/cc0000/ffffff&quot;
## 
## [[4]]
## [1] &quot;181x194&quot;           &quot;png/5fa2dd/ffffff&quot;
## 
## [[5]]
## [1] &quot;220x123&quot;           &quot;jpg/ff4444/ffffff&quot;
## 
## [[6]]
## [1] &quot;118x176&quot;           &quot;bmp/dddddd/000000&quot;</code></pre>
</div>
<div id="step-4-extract-the-first-element." class="section level4">
<h4>Step 4: Extract the first element.</h4>
<p>The above step resulted in a list which contains the
image dimension and the rest of the url. Each element
of the list is a character vector. We want to extract
the first value in the character vector. Let us use
<code>map_chr()</code> to extract the first value from each
element of the list.</p>
<pre class="r"><code>img %&gt;%
  str_sub(start = 23) %&gt;%
  str_split(pattern = &#39;\\.&#39;) %&gt;%
  map_chr(extract(1))</code></pre>
<pre><code>## [1] &quot;130x183&quot; &quot;106x217&quot; &quot;146x127&quot; &quot;181x194&quot; &quot;220x123&quot; &quot;118x176&quot;</code></pre>
</div>
</div>
</div>
<div id="extract-http-protocol-from-url" class="section level2">
<h2>Extract HTTP Protocol from URL</h2>
<pre class="r"><code>url1 &lt;- 
  mockstring %&gt;%
  pull(url) %&gt;%
  first

url1</code></pre>
<pre><code>## [1] &quot;https://engadget.com/nascetur/ridiculus/mus/vivamus/vestibulum.jsp?eu=est&amp;tincidunt=risus&amp;in=auctor&amp;leo=sed&amp;maecenas=tristique&amp;pulvinar=in&amp;lobortis=tempus&amp;est=sit&amp;phasellus=amet&amp;sit=sem&amp;amet=fusce&amp;erat=consequat&amp;nulla=nulla&amp;tempus=nisl&amp;vivamus=nunc&amp;in=nisl&amp;felis=duis&amp;eu=bibendum&amp;sapien=felis&amp;cursus=sed&amp;vestibulum=interdum&amp;proin=venenatis&amp;eu=turpis&amp;mi=enim&amp;nulla=blandit&amp;ac=mi&amp;enim=in&amp;in=porttitor&amp;tempor=pede&amp;turpis=justo&amp;nec=eu&amp;euismod=massa&amp;scelerisque=donec&amp;quam=dapibus&amp;turpis=duis&amp;adipiscing=at&amp;lorem=velit&amp;vitae=eu&amp;mattis=est&amp;nibh=congue&amp;ligula=elementum&amp;nec=in&amp;sem=hac&amp;duis=habitasse&amp;aliquam=platea&amp;convallis=dictumst&amp;nunc=morbi&amp;proin=vestibulum&amp;at=velit&amp;turpis=id&amp;a=pretium&amp;pede=iaculis&amp;posuere=diam&amp;nonummy=erat&amp;integer=fermentum&amp;non=justo&amp;velit=nec&amp;donec=condimentum&amp;diam=neque&amp;neque=sapien&amp;vestibulum=placerat&amp;eget=ante&amp;vulputate=nulla&amp;ut=justo&amp;ultrices=aliquam&amp;vel=quis&amp;augue=turpis&amp;vestibulum=eget&amp;ante=elit&amp;ipsum=sodales&amp;primis=scelerisque&amp;in=mauris&amp;faucibus=sit&amp;orci=amet&amp;luctus=eros&amp;et=suspendisse&amp;ultrices=accumsan&amp;posuere=tortor&amp;cubilia=quis&amp;curae=turpis&amp;donec=sed&amp;pharetra=ante&amp;magna=vivamus&amp;vestibulum=tortor&amp;aliquet=duis&amp;ultrices=mattis&amp;erat=egestas&amp;tortor=metus&amp;sollicitudin=aenean&amp;mi=fermentum&amp;sit=donec&quot;</code></pre>
<div id="steps-3" class="section level3">
<h3>Steps</h3>
<ul>
<li>split the url using the pattern <code>://</code></li>
<li>extract the first element</li>
</ul>
<div id="step-1-split-the-url-using-the-pattern-." class="section level4">
<h4>Step 1: Split the url using the pattern <code>://</code>.</h4>
<p>The HTTP protocol is the first part of the url and is
separated from the rest of the url by <code>:</code>. Let us
split the url using <code>str_split()</code> and using the
pattern <code>:</code>. Since <code>:</code> is a special character, we
will escape it using <code>\\</code>.</p>
<pre class="r"><code>url1 %&gt;%
  str_split(pattern = &#39;://&#39;) </code></pre>
<pre><code>## [[1]]
## [1] &quot;https&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
## [2] &quot;engadget.com/nascetur/ridiculus/mus/vivamus/vestibulum.jsp?eu=est&amp;tincidunt=risus&amp;in=auctor&amp;leo=sed&amp;maecenas=tristique&amp;pulvinar=in&amp;lobortis=tempus&amp;est=sit&amp;phasellus=amet&amp;sit=sem&amp;amet=fusce&amp;erat=consequat&amp;nulla=nulla&amp;tempus=nisl&amp;vivamus=nunc&amp;in=nisl&amp;felis=duis&amp;eu=bibendum&amp;sapien=felis&amp;cursus=sed&amp;vestibulum=interdum&amp;proin=venenatis&amp;eu=turpis&amp;mi=enim&amp;nulla=blandit&amp;ac=mi&amp;enim=in&amp;in=porttitor&amp;tempor=pede&amp;turpis=justo&amp;nec=eu&amp;euismod=massa&amp;scelerisque=donec&amp;quam=dapibus&amp;turpis=duis&amp;adipiscing=at&amp;lorem=velit&amp;vitae=eu&amp;mattis=est&amp;nibh=congue&amp;ligula=elementum&amp;nec=in&amp;sem=hac&amp;duis=habitasse&amp;aliquam=platea&amp;convallis=dictumst&amp;nunc=morbi&amp;proin=vestibulum&amp;at=velit&amp;turpis=id&amp;a=pretium&amp;pede=iaculis&amp;posuere=diam&amp;nonummy=erat&amp;integer=fermentum&amp;non=justo&amp;velit=nec&amp;donec=condimentum&amp;diam=neque&amp;neque=sapien&amp;vestibulum=placerat&amp;eget=ante&amp;vulputate=nulla&amp;ut=justo&amp;ultrices=aliquam&amp;vel=quis&amp;augue=turpis&amp;vestibulum=eget&amp;ante=elit&amp;ipsum=sodales&amp;primis=scelerisque&amp;in=mauris&amp;faucibus=sit&amp;orci=amet&amp;luctus=eros&amp;et=suspendisse&amp;ultrices=accumsan&amp;posuere=tortor&amp;cubilia=quis&amp;curae=turpis&amp;donec=sed&amp;pharetra=ante&amp;magna=vivamus&amp;vestibulum=tortor&amp;aliquet=duis&amp;ultrices=mattis&amp;erat=egestas&amp;tortor=metus&amp;sollicitudin=aenean&amp;mi=fermentum&amp;sit=donec&quot;</code></pre>
</div>
<div id="step-2-extract-the-first-element." class="section level4">
<h4>Step 2: Extract the first element.</h4>
<p>The HTTP protocol is the first value in each element
of the list. As we did in the previous example, we
will extact it using <code>map_chr()</code> and <code>extract()</code>.</p>
<pre class="r"><code>url1 %&gt;%
  str_split(pattern = &#39;://&#39;) %&gt;%
  map_chr(extract(1))</code></pre>
<pre><code>## [1] &quot;https&quot;</code></pre>
</div>
</div>
</div>
<div id="extract-file-type" class="section level2">
<h2>Extract file type</h2>
<pre class="r"><code>urls &lt;-
  mockstring %&gt;%
  use_series(url) %&gt;%
  extract(1:3)</code></pre>
<div id="steps-4" class="section level3">
<h3>Steps</h3>
<ul>
<li>check if there are only 2 dots in the URL</li>
<li>check if there is only 1 question mark in the URL</li>
<li>detect the staritng position of file type</li>
<li>tetect the ending position of file type</li>
<li>use the locations to specify the index position for extracting file type</li>
</ul>
<div id="step-1-check-if-there-are-only-2-dots-in-the-url" class="section level4">
<h4>Step 1: Check if there are only 2 dots in the URL</h4>
<p>Let us locate all the dots in the url using <code>str_locate_all()</code> and see
if any of them contain more than 2 dots.</p>
<pre class="r"><code>urls %&gt;%
  str_locate_all(pattern = &#39;\\.&#39;) %&gt;%
  map_int(nrow) %&gt;%
  is_greater_than(2) %&gt;%
  sum</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="step-2-check-if-there-is-only-1-question-mark-in-the-url" class="section level4">
<h4>Step 2: Check if there is only 1 question mark in the URL</h4>
<p>The next step is to check if there is only one <code>?</code> (question mark)
in the url.</p>
<pre class="r"><code>urls %&gt;%
  str_locate_all(pattern = &quot;[?]&quot;) %&gt;%
  map_int(nrow) %&gt;%
  is_greater_than(1) %&gt;%
  sum</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="step-3-detect-the-staritng-position-of-file-type" class="section level4">
<h4>Step 3: Detect the staritng position of file type</h4>
<p>Since the file type is located between the second dot and
the first quesiton mark in the url, let us extract the
location of the second dot and add 1 as the file type
starts after the dot.</p>
<pre class="r"><code>d &lt;- 
  urls %&gt;%
  str_locate_all(pattern = &#39;\\.&#39;) %&gt;%
  map_int(extract(2)) %&gt;%
  add(1)

d  </code></pre>
<pre><code>## [1] 64 47 48</code></pre>
</div>
<div id="step-4-detect-the-ending-position-of-file-type" class="section level4">
<h4>Step 4: Detect the ending position of file type</h4>
<p>In step 2, we confirmed that the url has only one question mark.
Let us locate the question mark in the url and subtract 1 (as the
file type ends before the question mark) so that we get the
ending postion of the file type.
.</p>
<pre class="r"><code>q &lt;-  
  urls %&gt;%
  str_locate_all(pattern = &quot;[?]&quot;) %&gt;%
  map_int(extract(1)) %&gt;%
  subtract(1)

q</code></pre>
<pre><code>## [1] 66 50 51</code></pre>
</div>
<div id="step-5-specify-the-index-position-for-extracting-file-type" class="section level4">
<h4>Step 5: Specify the index position for extracting file type</h4>
<p>From steps 3 and 4, we have the location of the second dot and the
first question mark in the url. Let us use them with <code>str_sub()</code>
to extract the file type.</p>
<pre class="r"><code>urls %&gt;% 
  str_sub(start = d, end = q)</code></pre>
<pre><code>## [1] &quot;jsp&quot;  &quot;json&quot; &quot;json&quot;</code></pre>
</div>
</div>
</div>
